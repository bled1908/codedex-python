"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9840],{17977:function(t,e,n){var r=n(82729),o=n(85893),i=n(19521),a=n(9473),s=n(67294),l=n(26245),c=n(34150),u=n(83584);function _templateObject(){let t=(0,r._)([""]);return _templateObject=function(){return t},t}i.default.div.withConfig({componentId:"sc-c0ad78ae-0"})(_templateObject()),e.Z=function(t){let{userToFollowUid:e,following:n,setFollowing:r}=t,i=(0,a.v9)(l.f8);(0,a.v9)(l.IC);let[d,m]=(0,s.useState)(!1),p=(0,s.useCallback)(async function(t){t.preventDefault();try{m(!0);let t=await (0,c.P)({userId:i,accountToFollowUid:e});if(200===t.status){let t=[...n,e];sessionStorage.setItem("userFollowing",JSON.stringify(t)),r(t),m(!1);try{(0,u.l)("follow",e,i)}catch(t){console.error("Error creating follow notification: ",t)}}}catch(t){}},[i,e,n,r]);return(0,o.jsx)("div",{className:"follow-user-btn",children:n.includes(e)?(0,o.jsx)("button",{className:"followed",children:"Following"}):(0,o.jsx)("button",{className:"follow",onClick:t=>p(t),children:"Follow"})})}},51894:function(t,e,n){var r=n(82729),o=n(85893),i=n(19521),a=n(9473),s=n(67294),l=n(5434),c=n(12238),u=n.n(c),d=n(12860),m=n(26245);function _templateObject(){let t=(0,r._)(["\n    from {\n        transform: scale(0.8);\n        visibility: hidden;\n        opacity: 0;\n    } to {\n        transform: scale(1);\n        visibility: visible;\n        opacity: 1;\n    }\n"]);return _templateObject=function(){return t},t}function _templateObject1(){let t=(0,r._)(["\n  z-index: 20;\n  position: fixed;\n  display: flex;\n  justify-content: center;\n  /* align-items: center; */\n  width: 100%;\n  height: 100%;\n  top: 0px;\n  background: rgba(0, 0, 0, 0.5);\n  color: whitesmoke;\n\n  "," {\n    .form {\n      position: relative;\n      margin-top: 2rem;\n      border: 2px solid\n        ",";\n      animation: "," 0.2s ease-in;\n      width: 700px;\n      height: fit-content;\n      background: ",";\n      padding: 1rem;\n      border-radius: 7px;\n\n      .profile-title-field {\n        display: flex;\n        margin-bottom: 1rem;\n        margin-top: 2.5rem;\n        img {\n          width: 40px;\n          height: 40px;\n          border-radius: 100px;\n        }\n\n        input {\n          flex: 1;\n          border: 2px solid\n            ",";\n          border-radius: 7px;\n          padding: 0.7rem;\n          margin-left: 1rem;\n          color: ",';\n          font-family: "Work Sans", sans-serif;\n          background: ',';\n          outline-width: 0;\n        }\n      }\n\n      .profanity-alert {\n        border: 2px solid red;\n        color: #e01a18;\n        border-radius: 5px;\n        padding: 0.5rem;\n        margin: 1rem auto;\n\n        p {\n          margin: 0px;\n          font-family: "Work Sans", sans-serif;\n          font-weight: 600;\n        }\n      }\n\n      textarea {\n        width: 100%;\n        min-height: 200px;\n        max-height: 400px;\n        background-color: #0e1524;\n        border: 2px solid rgba(36, 76, 115, 1);\n        outline-width: 0;\n        border-radius: 7px;\n        color: whitesmoke;\n        font-family: "Work Sans", sans-serif;\n        padding: 0.7rem;\n      }\n\n      .button-container {\n        margin-top: 0.5rem;\n        display: flex;\n        justify-content: space-between;\n\n        .media-buttons {\n          display: flex;\n          align-items: center;\n\n          div {\n            display: flex;\n            align-items: center;\n            align-items: center;\n            gap: 0.5rem;\n            margin-right: 1rem;\n\n            p {\n              margin: 0px;\n              color: whitesmoke;\n              font-family: "Work Sans", sans-serif;\n            }\n          }\n        }\n        button {\n          font-size: 14px;\n        }\n      }\n\n      .close-btn {\n        all: unset;\n        position: absolute;\n        right: 20px;\n        top: 10px;\n        font-size: 30px;\n        line-height: 0.8;\n        transition-duration: 0.2s;\n        padding: 0.2rem;\n        color: ',";\n\n        :hover {\n          background-color: hsla(61, 6%, 90%, 0.3);\n          border-radius: 50%;\n          cursor:\n            url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAzElEQVRYR+2X0Q6AIAhF5f8/2jYXZkwEjNSVvVUjDpcrGgT7FUkI2D9xRfQETwNIiWO85wfINfQUEyxBG2ArsLwC0jioGt5zFcwF4OYDPi/mBYKm4t0U8ATgRm3ThFoAqkhNgWkA0jJLvaOVSs7j3qMnSgXWBMiWPXe94QqMBMBc1VZIvaTu5u5pQewq0EqNZvIEMCmxAawK0DNkay9QmfFNAJUXfgGgUkLaE7j/h8fnASkxHTz0DGIBMCnBeeM7AArpUd3mz2x3C7wADglA8BcWMZhZAAAAAElFTkSuQmCC)\n              14 0,\n            pointer;\n        }\n      }\n    }\n  }\n  "," {\n    .form {\n      margin-top: 2rem;\n      max-height: 90vh;\n      overflow: hidden;\n    }\n  }\n\n  "," {\n    .form {\n      margin-top: 2rem;\n      max-height: 90vh;\n      overflow: hidden;\n    }\n  }\n  "," {\n    .form {\n      margin-top: 10rem;\n    }\n  }\n"]);return _templateObject1=function(){return t},t}let p=(0,s.lazy)(()=>Promise.all([n.e(2937),n.e(8764),n.e(7827),n.e(2466)]).then(n.bind(n,22466))),f=(0,i.keyframes)(_templateObject()),g=i.default.div.withConfig({componentId:"sc-a88b3e46-0"})(_templateObject1(),t=>{let{theme:e}=t;return e.breakpoints.xs},t=>"dark"===t.theme.mode?"rgba(36, 76, 115, 1)":"#DADADA",f,t=>"dark"===t.theme.mode?"#1d2332":"#FFFFFF",t=>"dark"===t.theme.mode?"rgba(36, 76, 115, 1)":"#DADADA",t=>"dark"===t.theme.mode?"rgba(255, 255, 255, 0.87)":"dark",t=>"dark"===t.theme.mode?"#0e1524":"#FFFFFF",t=>"dark"===t.theme.mode?"rgba(255, 255, 255, 0.87)":"black",t=>{let{theme:e}=t;return e.breakpoints.sm},t=>{let{theme:e}=t;return e.breakpoints.md},t=>{let{theme:e}=t;return e.breakpoints.lg});e.Z=function(t){let{setShowPostForm:e,allPosts:n,setAllPosts:r}=t,i=new(u()),c=(0,a.v9)(m.f8),f=(0,a.v9)(m.zr),h=localStorage.getItem("photoURL")||"",[w,b]=(0,s.useState)(""),[y,x]=(0,s.useState)(""),[v,k]=(0,s.useState)(!1);async function handleSubmit(t){t.preventDefault();let o=i.isProfane(w),a=i.isProfane(y);if(o||a){k(!0);return}try{let t=await (0,d.q)({communityName:"main",uid:c,title:w,imageFile:null,videoFiles:null,content:y,type:"post",parentPostId:""});if(200===t.status){let o={authorData:{username:f,photoURL:h},comments:0,...t.post};n?r([o,...n]):r([o]),e(!1)}}catch(t){console.error(t)}}return(0,o.jsx)(g,{children:(0,o.jsxs)("form",{className:"form",onClick:t=>t.stopPropagation(),onSubmit:t=>handleSubmit(t),children:[(0,o.jsx)("button",{className:"close-btn nes-pointer",children:(0,o.jsx)(l.lTq,{onClick:()=>e(!1)})}),(0,o.jsxs)("div",{className:"profile-title-field",children:[(0,o.jsx)("img",{src:h,alt:"user photo"}),(0,o.jsx)("input",{placeholder:"Title",value:w,onChange:t=>b(t.target.value),required:!0})]}),v&&(0,o.jsx)("div",{className:"profanity-alert",children:(0,o.jsx)("p",{children:"Cod\xe9dex is a community for all ages and groups. Please be considerate when making a post and remove any profanity."})}),(0,o.jsx)(s.Suspense,{fallback:(0,o.jsx)("div",{children:"Loading..."}),children:(0,o.jsx)(p,{setPostMainContent:x,value:""})}),(0,o.jsxs)("div",{className:"button-container",children:[(0,o.jsx)("div",{className:"media-buttons"}),(0,o.jsx)("button",{type:"submit",className:"nes-btn is-primary",children:"Post"})]})]})})}},34150:function(t,e,n){n.d(e,{P:function(){return followUser}});var r=n(39828),o=n(92369);async function followUser(t){let{userId:e,accountToFollowUid:n}=t;try{let{firestore:t}=(0,o.UM)(),i=(0,r.qs)(t),a=(0,r.JU)((0,r.hJ)(t,"followers-following"),e);i.set(a,{totalFollowingCount:(0,r.nP)(1),following:(0,r.vr)(n)},{merge:!0});let s=(0,r.JU)((0,r.hJ)(t,"followers-following"),n);return i.set(s,{totalFollowersCount:(0,r.nP)(1),followers:(0,r.vr)(e)},{merge:!0}),i.update(s,{["followersTimestamp.".concat(e)]:(0,r.Bt)()}),await i.commit(),{status:200}}catch(t){throw Error("Completely failed: "+t.message)}}},73664:function(t,e,n){n.d(e,{oH:function(){return getUserPostCommentsRef},x:function(){return getUserPostsRef}});var r=n(39828),o=n(92369);function getUserPostsRef(t){let{uid:e}=t,{firestore:n}=(0,o.UM)(),i=(0,r.JU)((0,r.hJ)(n,"users"),e,"community","posts");return i}function getUserPostCommentsRef(t){let{uid:e}=t,{firestore:n}=(0,o.UM)(),i=(0,r.JU)((0,r.hJ)(n,"users"),e,"community","comments");return i}},12860:function(t,e,n){n.d(e,{q:function(){return createPost}});var r=n(39828),o=n(92369),i=n(73664),a=n(86650);async function createPost(t){let{communityName:e,uid:n,title:s,imageFile:l,videoFiles:c,content:u,parentPostId:d,giphyData:m,projectSubmissionForCourse:p,type:f="post"}=t,{firestore:g}=(0,o.UM)(),h=(0,r.qs)(g);if("post"===f){if(!e||!n||!s||void 0===u)throw Error("which community, uid, title, and description are required fields.");try{let t=await fetch("/api/community/createPostCheck");if(200!==t.status)return{status:500,post:null}}catch(t){return console.error("Error creating post:",t),{status:500,post:null}}let t=(0,i.x)({uid:n}),o=(0,r.JU)(g,"uploadProgress",n),updateProgress=async(t,e)=>{await (0,r.pl)(o,{[t]:e},{merge:!0})};try{let o=(0,r.hJ)(g,"community",e,"posts"),i=(0,r.JU)(o),d={ownerUid:n,title:s,content:u,createdAt:(0,r.Bt)(),parent:null,postId:i.id,communityName:e,images:[],videoFiles:[],userComments:0,userLikes:0,userReports:0,reports:[]};if(p&&(d.projectSubmissionForCourse=p),l)try{let t=(0,a.cF)(),n=(0,a.iH)(t,"community/".concat(e,"/post/").concat(i.id,"/").concat(l.name));await (0,a.KV)(n,l);let r=await (0,a.Jt)(n);d.images.push({url:r})}catch(t){return console.error("Error uploading image:",t),{status:500,post:null}}if(c)try{let t,n,r;let o=(0,a.cF)(),{video:s,thumbNail:l}=c,u=(0,a.iH)(o,"community/".concat(e,"/post/").concat(i.id,"/").concat(s.name)),m=(0,a.B0)(u,s);l&&(n=(0,a.iH)(o,"community/".concat(e,"/post/").concat(i.id,"/").concat(l.name)),t=(0,a.B0)(n,l)),m.on("state_changed",async t=>{let e=t.bytesTransferred/t.totalBytes*100;await updateProgress("video",e)}),t&&t.on("state_changed",async t=>{let e=t.bytesTransferred/t.totalBytes*100;await updateProgress("thumbnail",e)});let p=null,f=[m.then(async()=>{r=await (0,a.Jt)(u),await updateProgress("video",0)})];t&&f.push(t.then(async()=>{p=await (0,a.Jt)(n),await updateProgress("thumbnail",0)})),await Promise.all(f),d.videoFiles.push({videoUrl:r,thumbNailUrl:p})}catch(t){return console.error("Error uploading files:",t),{status:500,post:null}}h.set(i,d),h.set(t,{postIds:(0,r.vr)(i.id)},{merge:!0}),await h.commit();let m=await (0,r.QT)(i),f=m.data();return{status:200,post:f}}catch(t){return console.error(t),{status:500,post:null}}}else{if(!n||!u&&!m)throw Error("uid, title, and description are required fields.");let t=(0,i.oH)({uid:n});try{let o=(0,r.hJ)(g,"community",e,"posts"),i=(0,r.JU)(o),c={ownerUid:n,title:s,images:[],content:u,createdAt:(0,r.Bt)(),parent:{id:d},postId:i.id,communityName:e,userLikes:0,userReports:0,giphyData:m};if(l)try{let t=(0,a.cF)(),n=(0,a.iH)(t,"community/".concat(e,"/post/").concat(i.id,"/").concat(l.name));await (0,a.KV)(n,l);let r=await (0,a.Jt)(n);c.images.push({url:r})}catch(t){return console.error("Error uploading image:",t),{status:500,post:null}}h.set(i,c),h.set(t,{commentIds:(0,r.vr)(i.id)},{merge:!0}),await h.commit();let p=await (0,r.QT)(i),f=p.data();return{status:200,post:f}}catch(t){return console.error(t),{status:500,post:null}}}}},83584:function(t,e,n){n.d(e,{l:function(){return createFollowNotification}});var r=n(39828),o=n(92369);async function createFollowNotification(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"comment",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(!e||!n)throw Error("postOwnerUid, senderUid, postId, and postLink are required fields.");let{firestore:i}=(0,o.UM)();try{let o=(0,r.JU)(i,"communityNotifications",e),a=(0,r.hJ)(o,"notifications"),s=(0,r.IO)(a,(0,r.ar)("type","==",t),(0,r.ar)("receiver","==",e),(0,r.ar)("senderUid","==",n)),l=await (0,r.PL)(s);if(0===l.size){let o={type:t,senderUid:n,read:!1,receiver:e,createdAt:(0,r.Bt)()};return await (0,r.ET)(a,o),{status:200}}}catch(t){return console.log("Error creating notification: ",t),{status:500}}}}}]);